!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Stat=e.Detector=void 0;var a=function(t){function e(){var e=t.call(this)||this;return e.stat=new s,e}return o(e,t),e.prototype.start=function(t,e){var r=this,n=this.stat;this.stop(),e&&(this.checkIntervalId=window.setInterval((function(){t&&t.getStats(null).then((function(t){n.update(t),r.emit("update",n)}))}),e))},e.prototype.stop=function(){this.checkIntervalId&&clearInterval(this.checkIntervalId)},e}(i(r(2)).default);e.Detector=a;var s=function(){function t(){this.timestamp=0,this.timestampStart=0,this.packetsLost=0,this.frame={decoded:0,dropped:0,received:0,decodedStart:0,height:0,width:0},this.bytes={received:0,receivedStart:0},this.bitrate={current:0,average:0,low:1/0,high:-1/0},this.framerate={current:0,average:0,low:1/0,high:-1/0}}return t.formatBytes=function(t){for(var e=t,r="B",n=["kB","MB","GB"],o=0,i=n.length;o<i&&!(e<1e3);o++)e/=1e3,r=n[o];return""+e.toFixed(1)+r},t.prototype.update=function(t){var e=this;t.forEach((function(t){var r=t.type,n=t.isRemote,o=t.mediaType,i=t.id,a=t.timestamp,s=t.bytesReceived,c=t.framesDropped,d=t.framesReceived,h=t.frameWidth,u=t.frameHeight,p=t.framesDecoded,l=t.packetsLost,f=t.currentRoundTripTime;"inbound-rtp"!==r||n||"video"!==o&&!i.toLowerCase().includes("video")||(e.calBitrate(t),e.calFrameRate(t),e.timestamp=a,e.timestampStart=e.timestampStart||a,e.packetsLost=l,e.bytes={received:s,receivedStart:e.bytes.receivedStart||s}),"candidate-pair"===r&&t.hasOwnProperty("currentRoundTripTime")&&(e.currentRoundTripTime=f),"track"===r&&(e.frame={dropped:c,received:d,decoded:p,width:h,height:u,decodedStart:e.frame.decodedStart||p}),"remote-candidate"===r&&(e.candidate={ip:t.ip,port:t.port,protocol:t.protocol,type:t.candidateType})}))},t.prototype.calFrameRate=function(t){var e=this.frame,r=e.decoded,n=e.decodedStart;if(r&&n){var o=~~((t.framesDecoded-r)/((t.timestamp-this.timestamp)/1e3)),i=Math.min(this.framerate.low,o),a=Math.max(this.framerate.high,o),s=~~((t.framesDecoded-n)/((t.timestamp-this.timestampStart)/1e3));this.framerate={current:o,low:i,high:a,average:s}}},t.prototype.calBitrate=function(t){var e=this.timestamp,r=this.bytes,n=r.received,o=r.receivedStart;if(n&&o&&e){var i=~~(8*(t.bytesReceived-n)/(t.timestamp-e)),a=Math.min(i,this.bitrate.low),s=Math.max(i,this.bitrate.high),c=~~(8*(t.bytesReceived-o)/(t.timestamp-this.timestampStart));Object.assign(this.bitrate,{current:i,low:a,high:s,average:c})}},t}();e.Stat=s},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),o(r(0),e),o(r(3),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.events={}}return t.prototype.hasListener=function(t){var e=this.events;return!!e&&!!e[t]&&e[t].length>0},t.prototype.on=function(t,e,r,n){var o=this;void 0===n&&(n=!1);for(var i=this.events,a=0,s=[].concat(t);a<s.length;a++){var c=s[a];i[c]||(i[c]=[]),i[c].push([e,r,n])}return function(){return o.off(t,e)}},t.prototype.off=function(t,e){if(t||e){for(var r=this.events,n=0,o=[].concat(t);n<o.length;n++){var i=o[n];void 0!==r[i]&&(void 0!==e?r[i]=r[i].filter((function(t){return t[0]!==e})):r[i].length=0)}return this}this.events={}},t.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=!1,o=this.events[t]||[],i=0,a=o;i<a.length;i++){var s=a[i];try{var c=s[0],d=s[1],h=void 0===d?this:d,u=s[2],p=void 0!==u&&u,l=c.apply(h,e);p&&this.off(t,c),!1===l&&(n=!0)}catch(t){console.log(t)}}return n},t}();e.default=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=void 0;var n=r(0);r(4);var o=r(8),i=function(){function t(){var e=this;this.update=function(t){var r=e,n=r.showType,o=r.iconType;e.framerates.push(t.framerate.current),e.framerates.shift(),e.bitrates.push(t.bitrate.current),e.bitrates.shift(),"icon"===n?0===o?e.renderFPS(t):1===o&&e.renderSpeed(t):"table"===n&&e.renderTable(t)},this.detector=void 0,this.root=t.generateDom(),this.canvas=t.generateCanvas(),this.table=t.generateTable(),this.textNode=t.generateTextNode(),this.ctx=this.canvas.getContext("2d"),this.textNode.innerText="No Connect",this.showType="icon",this.iconType=0,this.root.appendChild(this.canvas),this.root.appendChild(this.textNode),this.root.appendChild(this.table),document.body.appendChild(this.root),this.initData(),this.bindEvent(),this.autoSwitch=window.setInterval((function(){0===e.iconType?e.iconType=1:1===e.iconType&&(e.iconType=0)}),5e3),this.setShowType(this.showType)}return t.fromPeerConnection=function(e,r){var o=new n.Detector,i=new t;return i.listen(o),o.start(e,r),i},t.formatTime=function(t){var e=t,r=~~(e/3600),n=~~((e%=3600)/60),o=~~(e%=60);return r?r+"h"+n+"m"+o+"s":n?n+"m"+o+"s":o+"s"},t.generateDom=function(){var t=o.getScale(),e=document.createElement("div");return e.classList.add("webrtc-stat-root"),e.style.fontSize=12*t+"px",e},t.generateCanvas=function(){var t=document.createElement("canvas");return t.setAttribute("width","100"),t.setAttribute("height","100"),t.classList.add("webrtc-stat-canvas"),t},t.generateTable=function(){var t=document.createElement("table");return t.classList.add("webrtc-stat-table"),t},t.generateTextNode=function(){var t=document.createElement("div");return t.classList.add("webrtc-stat-text"),t},t.prototype.setSize=function(t){this.root.style.transform="scale("+t+")"},t.prototype.listen=function(t){this.detector=t,t.on("update",this.update)},t.prototype.reset=function(){this.detector.off("update",this.update),this.detector=void 0},t.prototype.setShowType=function(t){this.showType=t,this.root.setAttribute("show-type",t)},t.prototype.initData=function(){this.framerates=new Array(51).fill(0),this.bitrates=new Array(51).fill(0)},t.prototype.bindEvent=function(){var t=this;this.root.addEventListener("click",(function(){"icon"===t.showType?t.setShowType("table"):"table"===t.showType&&t.setShowType("icon")}))},t.prototype.renderTable=function(e){var r=this.table,o='\n            <tbody>\n                <tr><th colspan="4" class="title">Core Stats</th></tr>\n                <tr><th>Time</th><th>Received</th><th>PacketsLost</th><th>Latency</th></tr>\n                <tr>\n                    <td>'+t.formatTime((e.timestamp-e.timestampStart)/1e3)+"</td>\n                    <td>"+n.Stat.formatBytes(e.bytes.received)+"</td>\n                    <td>"+e.packetsLost+"</td>\n                    <td>"+~~(1e3*e.currentRoundTripTime)+'</td>\n                </tr>\n                <tr><th colspan="4" class="title">Frame Stats</th></tr>\n                <tr><th>Received</th><th>Decoded</th><th>Dropped</th><th>Size</th></tr>\n                <tr>\n                    <td>'+e.frame.received+"</td>\n                    <td>"+e.frame.decoded+"</td>\n                    <td>"+e.frame.dropped+"</td>\n                    <td>"+e.frame.width+"x"+e.frame.height+'</td> \n                </tr> \n                <tr><th colspan="4" class="title">Bitrate Stats (kbps)</th></tr>\n                <tr><th>current</th><th>average</th><th>low</th><th>high</th></tr>\n                <tr>\n                    <td>'+e.bitrate.current+"</td>\n                    <td>"+e.bitrate.average+"</td>\n                    <td>"+e.bitrate.low+"</td>\n                    <td>"+e.bitrate.high+'</td>\n                </tr>\n                <tr><th colspan="4" class="title">Candidate Info</th></tr>\n                <tr><th>ip</th><th>port</th><th>protocol</th><th>type</th></tr>\n                <tr>\n                    <td>'+e.candidate.ip+"</td>\n                    <td>"+e.candidate.port+"</td>\n                    <td>"+e.candidate.protocol+"</td>\n                    <td>"+e.candidate.type+"</td>\n                </tr>\n            </tbody>\n        ";r.innerHTML=o},t.prototype.renderSpeed=function(t){var e=this.bitrates,r=t.bitrate.current,o=n.Stat.formatBytes(r/8*1e3).toUpperCase()+"/s";this.drawAreaChart(e,"rgb(8, 255, 200)",{min:0}),this.renderText(o,"rgb(8, 255, 200)")},t.prototype.renderFPS=function(t){var e=this.framerates,r=t.framerate,n=r.current,o=r.high,i=~~n+"FPS("+r.low+"-"+o+")";this.drawAreaChart(e,"rgb(59, 184, 215)",{min:0}),this.renderText(i,"rgb(59, 184, 215)")},t.prototype.renderText=function(t,e){this.textNode.innerText=t,this.textNode.style.color=e},t.prototype.drawAreaChart=function(t,e,r){var n,o=this.ctx,i=this.canvas,a=i.width,s=i.height,c=r.max,d=void 0===c?Math.max.apply(Math,t):c,h=r.min,u=void 0===h?Math.min.apply(Math,t):h,p=a/(t.length-1);o.clearRect(0,0,a,s),o.beginPath(),o.moveTo(0,s);for(var l=0,f=t.length;l<f;l++){var v=l*p,m=(n=t[l],~~(s-(n-u)/(d-u)*s*.8));o.lineTo(v,m)}o.lineTo(a,s),o.closePath(),o.fillStyle=e,o.fill()},t}();e.Renderer=i},function(t,e,r){var n=r(5),o=r(6);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var i={insert:"head",singleton:!1};n(o,i);t.exports=o.locals||{}},function(t,e,r){"use strict";var n,o=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},i=function(){var t={};return function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}t[e]=r}return t[e]}}(),a=[];function s(t){for(var e=-1,r=0;r<a.length;r++)if(a[r].identifier===t){e=r;break}return e}function c(t,e){for(var r={},n=[],o=0;o<t.length;o++){var i=t[o],c=e.base?i[0]+e.base:i[0],d=r[c]||0,h="".concat(c," ").concat(d);r[c]=d+1;var u=s(h),p={css:i[1],media:i[2],sourceMap:i[3]};-1!==u?(a[u].references++,a[u].updater(p)):a.push({identifier:h,updater:m(p,e),references:1}),n.push(h)}return n}function d(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var o=r.nc;o&&(n.nonce=o)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),"function"==typeof t.insert)t.insert(e);else{var a=i(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var h,u=(h=[],function(t,e){return h[t]=e,h.filter(Boolean).join("\n")});function p(t,e,r,n){var o=r?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=u(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function l(t,e,r){var n=r.css,o=r.media,i=r.sourceMap;if(o?t.setAttribute("media",o):t.removeAttribute("media"),i&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var f=null,v=0;function m(t,e){var r,n,o;if(e.singleton){var i=v++;r=f||(f=d(e)),n=p.bind(null,r,i,!1),o=p.bind(null,r,i,!0)}else r=d(e),n=l.bind(null,r,e),o=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else o()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=o());var r=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<r.length;n++){var o=s(r[n]);a[o].references--}for(var i=c(t,e),d=0;d<r.length;d++){var h=s(r[d]);0===a[h].references&&(a[h].updater(),a.splice(h,1))}r=i}}}},function(t,e,r){(e=r(7)(!1)).push([t.i,".webrtc-stat-root{position:fixed;background:rgba(0,0,0,.7);font-size:12px}.webrtc-stat-root[show-type=icon]{width:8em;height:8em;top:4em;right:4em}.webrtc-stat-root[show-type=icon] .webrtc-stat-canvas,.webrtc-stat-root[show-type=icon] .webrtc-stat-text{display:block}.webrtc-stat-root[show-type=icon] .webrtc-stat-table{display:none}.webrtc-stat-root[show-type=table]{top:4em;width:25em;height:auto;left:0;right:0;margin:auto;background:rgba(0,0,0,.3);display:inline-block}.webrtc-stat-root[show-type=table] .webrtc-stat-table{display:table;margin:auto}.webrtc-stat-root[show-type=table] .webrtc-stat-table .title{text-align:center}.webrtc-stat-root[show-type=table] .webrtc-stat-table td,.webrtc-stat-root[show-type=table] .webrtc-stat-table th{text-align:left}.webrtc-stat-root[show-type=table] .webrtc-stat-canvas,.webrtc-stat-root[show-type=table] .webrtc-stat-text{display:none}.webrtc-stat-root .webrtc-stat-canvas{position:absolute;width:100%;height:6em;bottom:0;left:0}.webrtc-stat-root .webrtc-stat-text{position:absolute;width:100%;height:2em;line-height:2em;font-size:1em;top:0;left:0;background:rgba(4,18,169,.5);color:#3bb8d7}",""]),t.exports=e},function(t,e,r){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=function(t,e){var r=t[1]||"",n=t[3];if(!n)return r;if(e&&"function"==typeof btoa){var o=(a=n,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(c," */")),i=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[r].concat(i).concat([o]).join("\n")}var a,s,c;return[r].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(r,"}"):r})).join("")},e.i=function(t,r,n){"string"==typeof t&&(t=[[null,t,""]]);var o={};if(n)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(o[a]=!0)}for(var s=0;s<t.length;s++){var c=[].concat(t[s]);n&&o[c[0]]||(r&&(c[2]?c[2]="".concat(r," and ").concat(c[2]):c[2]=r),e.push(c))}},e}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getScale=void 0,e.getScale=function(){var t=1,e=document.head.getElementsByTagName("meta"),r=Array.prototype.filter.call(e,(function(t){return"viewport"===t.name}))[0];if(r){var n=r.content,o=Number(n.match(/\binitial-scale=([\d.]*)\b/)[1]);o&&!Number.isNaN(o)&&(t=1/o)}return t}}])}));